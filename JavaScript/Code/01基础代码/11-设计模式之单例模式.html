<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>单例模式</title>
	<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
</head>
<body>
<p id="a">p label</p>
<script>
	var xiaowang = (function () {
		var xiaowangjia = function (message) {
			this.menling = message;
		}
		var men;
		var info = {
			sendMessage(message) {
				if (!men) {
					men = new xiaowangjia(message);
				}
				return men;
			}
		};
		return info;
	})();
	
	var xiaoli = {
		callXiaowang: function (msg) {
			var _xw = xiaowang.sendMessage(msg);
			console.log(_xw.menling);
			_xw = null
		}
	}
	xiaoli.callXiaowang('didi, open door')
</script>
<script>
	window.onload = function () {
		var topThis = null;
		var bannerThis = null;
		var top = {
			a: 4,
			init() {
				this.render();
				this.bind();
			},
			render() {
				console.log('top render this');
				console.log(this);
				topThis = this;
				var me = this;
				me.banner = $('#a')
			},
			bind() {
				console.log('top bind this');
				console.log(this);
				var me = this;
				me.banner.click(function () {
					me.test();
				})
			},
			test() {
				a = 6
			}
		}
		
		var banner = {
			init() {
				this.render();
				this.bind();
			},
			a: 4,
			render() {
				console.log('banner render this');
				console.log(this);
				bannerThis = this;
				var me = this;
				me.banner = $('#a')
			},
			bind() {
				console.log('banner bind this');
				console.log(this);
				var me = this;
				me.banner.click(function () {
					me.test()
				})
			},
			test() {
				top.a = 10
			}
		};
		console.log(topThis === bannerThis); //true
		top.init();
		banner.init();
	}
</script>
</body>
</html>